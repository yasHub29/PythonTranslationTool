<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç¿»è¨³ãƒ„ãƒ¼ãƒ«</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç¿»è¨³ãƒ„ãƒ¼ãƒ«</h1>
        <p class="subtitle">PPTã€EXCELã€WORDãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã€è‹±èªãƒ»æ—¥æœ¬èªãƒ»ãƒ™ãƒˆãƒŠãƒ èªã®ç¿»è¨³ã‚’è¡Œã„ã¾ã™ã€‚</p>

        <form action="/translate" method="post" enctype="multipart/form-data" id="translate_form">

            <!-- === ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ— === -->
            <label>ğŸ“„ ç¿»è¨³ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ï¼š</label>
            <div id="drop_zone" class="drop-zone">
                <p>ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹ã‹ã€é¸æŠã—ã¦ãã ã•ã„</p>
                <input type="file" name="file" id="file" required>
            </div>

            <!-- ç¿»è¨³å…ƒ -->
            <label for="translate_from">ç¿»è¨³å…ƒã®è¨€èªï¼š</label>
            <select name="translate_from" id="translate_from" required>
                <option value="">è¨€èªã‚’é¸æŠã—ã¦ãã ã•ã„</option>
                <option value="en">è‹±èª</option>
                <option value="ja">æ—¥æœ¬èª</option>
                <option value="vi">ãƒ™ãƒˆãƒŠãƒ èª</option>
            </select>

            <!-- ç¿»è¨³å…ˆ -->
            <label for="translate_to">ç¿»è¨³å…ˆã®è¨€èªï¼š</label>
            <select name="translate_to" id="translate_to" required>
                <option value="">è¨€èªã‚’é¸æŠã—ã¦ãã ã•ã„</option>
                <option value="en">è‹±èª</option>
                <option value="ja">æ—¥æœ¬èª</option>
                <option value="vi">ãƒ™ãƒˆãƒŠãƒ èª</option>
            </select>

            <button type="submit" id="translate_button">ç¿»è¨³ã‚’é–‹å§‹</button>

            <div id="loading_area" class="loading-area hidden">
                <div class="spinner"></div>
                <p>ç¿»è¨³ä¸­ã§ã™ã€‚ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„...</p>
            </div>

        </form>

        {% with messages = get_flashed_messages() %}
        {% if messages %}
            <div class="flash">
                {% for msg in messages %}
                    <p>âš ï¸ {{ msg }}</p>
                {% endfor %}
            </div>
        {% endif %}
        {% endwith %}
    </div>

    <footer>
        <p>Â© 2025 ã‚¨ãƒ«ã‚¨ã‚¹ã‚¢ã‚¤é–‹ç™ºç ”ç©¶æ‰€</p>
    </footer>

<script>
/* === Drag & Drop File Upload === */
const dropZone = document.getElementById("drop_zone");
const fileInput = document.getElementById("file");

dropZone.addEventListener("click", () => fileInput.click());

fileInput.addEventListener("change", () => {
    if (fileInput.files.length > 0) {
        dropZone.querySelector("p").textContent = fileInput.files[0].name;
    }
});

dropZone.addEventListener("dragover", (e) => {
    e.preventDefault();
    dropZone.classList.add("dragover");
});

dropZone.addEventListener("dragleave", () => {
    dropZone.classList.remove("dragover");
});

dropZone.addEventListener("drop", (e) => {
    e.preventDefault();
    dropZone.classList.remove("dragover");

    if (e.dataTransfer.files.length > 0) {
        fileInput.files = e.dataTransfer.files;
        dropZone.querySelector("p").textContent = e.dataTransfer.files[0].name;
    }
});


/* === ç¿»è¨³å…ƒã¨ç¿»è¨³å…ˆã®æ’ä»– === */
document.getElementById("translate_from").addEventListener("change", function () {
    const from = this.value;
    const toSelect = document.getElementById("translate_to");
    const options = toSelect.querySelectorAll("option");

    options.forEach(opt => {
        opt.disabled = false;
        if (opt.value === from) {
            opt.disabled = true;
        }
    });

    if (toSelect.value === from) {
        toSelect.value = "";
    }
});


/* === èª­ã¿è¾¼ã¿ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ === */
document.getElementById("translate_form").addEventListener("submit", function () {
    const btn = document.getElementById("translate_button");
    const loading = document.getElementById("loading_area");

    btn.disabled = true;
    btn.classList.add("disabled");
    loading.classList.remove("hidden");
});
</script>

</body>
</html>
